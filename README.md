# FamilyTreeBot

**FamilyTreeBot** — это Telegram-бот для поиска информации о ваших родственниках и друзьях по имени и фамилии. Проект реализован на Python с использованием библиотеки **aiogram** и базой данных **PostgreSQL**.   
Этот бот предназначен только для просмотра информации.  
Но прежде всего нужно сначала запустить бот [PersonnelManagerBot](https://github.com/ATAGAEV95/PersonnelManagerBot) для того чтобы администрировать эти данные.


---

## Описание проекта

FamilyTreeBot помогает быстро находить сведения о людях из вашей личной базы — просто напишите имя и фамилию в чате с ботом, чтобы получить информацию, например, дату рождения. Бот также отправляет ежедневные напоминания о днях рождения ваших близких.

---

## Технологии

| Компонент     | Используется    |
|---------------|----------------|
| Язык          | Python 3.10+    |
| Библиотека    | aiogram         |
| Планировщик   | APScheduler     |
| СУБД          | PostgreSQL      |
| ORM           | SQLAlchemy      |

---

## Возможности

- Просмотр информации о родственниках и друзьях
- Быстрый поиск по имени и фамилии
- Ежедневные уведомления о днях рождения
- Поддержка нескольких Telegram-пользователей

---

## Как это работает

1. Пользователь отправляет имя и фамилию прямо в чат с ботом.
2. Бот ищет совпадения в базе данных и выдаёт найденные данные.
3. Всем пользователям ежедневно отправляются напоминания о днях рождения.

---

## Предварительные настройки бота

Нужно внести изменения в файл [config.py](https://github.com/ATAGAEV95/FamilyTreeBot/blob/develop/config.py), удалить оттуда все, оставив только это:
```python
TG_TOKEN = 'Ваш токен телеграмм бота'

# Ваше подключение к БД Postgres
DATABASE_URL = "postgresql+asyncpg://login:password@host:port/bdname"

# Ваша схема из БД Postgres, по умолчанию "public"
SCHEMA = "public"
```
Ввести ваш токен телеграмм бота.   
В DATABASE_URL надо внести:  
`login` - логин базы данных  
`password` - пароль базы данных  
`host` - хост базы данных, например 192.168.0.1  
`port` - порт базы данных, обычно это 5432 для Postgres  
`bdname` - имя базы данных      

---

## Пароль для бота

Пароль надо написать в файле [handlers.py](https://github.com/ATAGAEV95/FamilyTreeBot/blob/develop/app/handlers.py) в строке:
```python
ACCESS_PASSWORD = 'e5ae93bd8095fbd86c25a110bbf194a5a1a209f1e8eb31bb30c8b0ecbe254d58'
```
Это пароль, закодированный с использованием хэш-функции.   
Чтобы получить такой пароль используйте функцию `hash_password`:
```python
import hashlib

def hash_password(password: str) -> str:
    return hashlib.sha256(password.encode('utf-8')).hexdigest()

print(hash_password('12345678')) #ef797c8118f02dfb649607dd5d3f8c7623048c9c063d532cc95c5ed7a898a64f
```
Можно закодировать ваш любой пароль, а полученный хэш вести в `ACCESS_PASSWORD`

---

## Как запустить бота

Чтобы создать образы Docker, перейдите в корневой каталог проекта в терминале и выполните следующую команду:
```bash
docker build . -t familytreebot
```
Чтобы запустить контейнер Docker, выполните следующую команду:
```bash
docker run -d --name fambot familytreebot
```
Чтобы посмотреть все работающие контейнеры:
```bash
docker ps
```
Чтобы остановить и если надо удалить контейнер Docker:
```bash
docker stop fambot
docker rm fambot
```

---

